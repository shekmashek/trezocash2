/*
          # Add Currency to Budget Entries
          Adds currency-related columns to the `budget_entries` table for multi-currency support.

          ## Query Description: This operation adds `currency`, `original_amount`, `amount_type`, `vat_rate_id`, `ht_amount`, and `ttc_amount` columns to the `budget_entries` table. This is a non-destructive change required for multi-currency and advanced VAT calculations.
          
          ## Metadata:
          - Schema-Category: "Structural"
          - Impact-Level: "Low"
          - Requires-Backup: false
          - Reversible: true
          
          ## Structure Details:
          - Table Modified: `budget_entries`
          - Columns Added: `currency` (TEXT), `original_amount` (NUMERIC), `amount_type` (TEXT), `vat_rate_id` (UUID), `ht_amount` (NUMERIC), `ttc_amount` (NUMERIC)
          
          ## Security Implications:
          - RLS Status: Unchanged
          - Policy Changes: No
          - Auth Requirements: None
          
          ## Performance Impact:
          - Indexes: None
          - Triggers: None
          - Estimated Impact: Negligible.
          */

ALTER TABLE public.budget_entries
ADD COLUMN IF NOT EXISTS currency TEXT,
ADD COLUMN IF NOT EXISTS original_amount NUMERIC,
ADD COLUMN IF NOT EXISTS amount_type TEXT,
ADD COLUMN IF NOT EXISTS vat_rate_id UUID REFERENCES public.vat_rates(id),
ADD COLUMN IF NOT EXISTS ht_amount NUMERIC,
ADD COLUMN IF NOT EXISTS ttc_amount NUMERIC;
